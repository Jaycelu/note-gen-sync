# Syslog 批量配置工具

## 📋 项目简介

这是一个基于 Python 和 Netmiko 的网络设备 Syslog 批量配置工具，支持多种网络设备品牌，包括华为、H3C、思科、锐捷等。工具提供图形界面和命令行两种使用方式，可以批量配置设备的 Syslog 日志服务器。

## ✨ 主要特性

- 🔧 **多设备支持**：支持华为、H3C、思科、锐捷、瞻博网络、飞塔等多种设备
- 🚀 **批量配置**：支持多线程并发配置，提高效率
- 🖥️ **图形界面**：提供友好的 GUI 界面，操作简单
- 📊 **实时进度**：显示配置进度和结果统计
- ✅ **配置验证**：自动验证配置是否生效
- 📝 **详细日志**：记录详细的配置过程和结果
- 💾 **结果导出**：支持将配置结果导出到文件

## 🛠️ 环境要求

### Python 版本
- Python 3.6 或更高版本

### 依赖包
```bash
pip install netmiko pandas tk
```

## 📁 文件结构

```
Netdevops/
├── 批量下发syslog配置.py    # 主程序文件
├── Sinfo.csv               # 设备信息配置文件
└── README.md              # 说明文档
```

## 📝 Sinfo.csv 配置说明

### 文件格式
- **文件格式**：CSV (逗号分隔值)
- **编码**：UTF-8
- **文件名**：Sinfo.csv

### 必需字段

| 字段名 | 说明 | 示例 |
|--------|------|------|
| Type | 设备描述名称 | h3c, huawei |
| IP | 设备IP地址 | 10.19.224.253 |
| ssh_type | SSH设备类型 | hp_comware, huawei |
| User | 登录用户名 | admin |
| Passwd | 登录密码 | admin |

### 支持的设备类型

| 设备品牌 | ssh_type值 | 说明 |
|---------|-----------|------|
| 华为 | `huawei` | 华为设备 |
| H3C | `hp_comware` | H3C设备 |
| 思科IOS | `cisco_ios` | 思科IOS设备 |
| 思科IOS-XE | `cisco_xe` | 思科IOS-XE设备 |
| 思科NX-OS | `cisco_nxos` | 思科NX-OS设备 |
| 锐捷 | `ruijie` | 锐捷设备 |
| 瞻博网络 | `juniper` | 瞻博网络设备 |
| 飞塔 | `fortinet` | 飞塔设备 |
| Arista | `arista` | Arista设备 |
| Palo Alto | `paloalto` | Palo Alto设备 |

### 配置示例

```csv
Type,IP,ssh_type,User,Passwd
h3c,10.19.224.253,hp_comware,admin,admin
huawei,10.128.2.2,huawei,admin,admin
```

## 🚀 使用方法

### 1. 准备设备信息文件

创建 `Sinfo.csv` 文件，按照上述格式填写设备信息。

### 2. 运行程序

```bash
python 批量下发syslog配置.py
```

### 3. 图形界面操作

1. **选择文件**：点击"浏览"按钮选择 Sinfo.csv 文件
2. **配置参数**：
   - 日志服务器地址：默认为 `10.10.10.11`
   - 最大线程数：默认为 `10`
3. **开始配置**：点击"运行配置"按钮
4. **查看结果**：在结果区域查看配置进度和结果
5. **导出结果**：配置完成后可以导出结果到文件

## ⚙️ 配置参数

### 日志服务器设置
- **默认地址**：`10.40.29.201`
- **端口**：`514` (UDP)
- **协议**：Syslog

### 线程设置
- **默认线程数**：`10`
- **建议范围**：5-20
- **注意事项**：线程数过多可能导致设备响应缓慢

## 🔧 配置命令

### H3C设备 (hp_comware)
```bash
info-center loghost 10.10.10.11
info-center enable
info-center console channel 6
info-center console log level informational
```

### 华为设备 (huawei)
```bash
info-center loghost 10.40.29.201 source-ip 设备IP
info-center enable
info-center console channel 6
info-center console log level informational
```

### 思科设备 (cisco_ios)
```bash
logging 10.40.29.201
logging console informational
logging buffered informational
```

## 📊 输出结果

### 成功配置示例
```
============================================================
批量配置执行结果汇总
============================================================
总耗时: 45.23 秒
总设备数: 3 台
成功配置: 2 台
配置失败: 1 台
跳过设备: 0 台

✅ 成功配置的交换机 (2 台):
  1. 10.19.224.253
  2. 10.128.2.2

❌ 配置失败的交换机 (1 台):
  1. 10.19.254.1 - 失败原因: 连接超时

📊 配置成功率: 66.7% (2/3)
============================================================
```

## 🔍 故障排除

### 常见问题

1. **连接超时**
   - 检查网络连通性
   - 确认设备IP地址正确
   - 检查防火墙设置

2. **认证失败**
   - 确认用户名密码正确
   - 检查SSH服务是否启用
   - 确认用户权限

3. **配置验证失败**
   - 检查日志服务器地址是否正确
   - 确认设备支持Syslog配置
   - 查看详细日志输出

4. **CSV文件格式错误**
   - 确认文件编码为UTF-8
   - 检查字段名称是否正确
   - 确认设备类型支持

### 日志文件

程序运行时会生成日志文件：
- 文件名格式：`syslog_config_YYYYMMDD_HHMMSS.log`
- 包含详细的配置过程和错误信息

## 🆕 更新日志

### v1.1 (当前版本)
- ✅ 修复H3C设备配置验证问题
- ✅ 支持hp_comware设备类型
- ✅ 优化验证逻辑，提高准确性
- ✅ 改进错误处理和日志记录

### v1.0
- 🎉 初始版本发布
- 🎉 支持多种设备类型
- 🎉 提供图形界面

## 📞 技术支持

如果您在使用过程中遇到问题，请：

1. 查看日志文件获取详细错误信息
2. 确认设备信息配置正确
3. 检查网络连接和权限设置
4. 参考故障排除部分

## 📄 许可证

本项目采用 MIT 许可证，详见 LICENSE 文件。

---

**注意**：使用前请确保您有权限对目标设备进行配置，并建议在测试环境中先验证配置效果。 
